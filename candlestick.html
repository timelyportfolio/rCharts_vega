<!doctype HTML>
<meta charset = 'utf-8'>
<html>
  <head>
    <link rel='stylesheet' href='./libraries/frameworks/uikit/css/uikit.min.css'>
    <link rel='stylesheet' href='./libraries/frameworks/uikit/css/docs.css'>
    <link rel='stylesheet' href='./css/googleopensans.css'>
    <link rel='stylesheet' href='./libraries/frameworks/uikit/css/index.css'>
    <link rel='stylesheet' href='./libraries/frameworks/uikit/css/jumbotron.css'>
    <link rel='stylesheet' href='./libraries/highlighters/highlight.js/css/solarized_dark.css'>
    <link rel='stylesheet' href='./css/local.css'>
    
    <script src='./js/jquery.min.js' type='text/javascript'></script>
    <script src='./libraries/frameworks/uikit/js/uikit.min.js' type='text/javascript'></script>
    <script src='./js/angular.min.js' type='text/javascript'></script>
    <script src='./js/ace.js' type='text/javascript'></script>
    <script src='./js/ui-ace.min.js' type='text/javascript'></script>
    <script src='./js/lodash.js' type='text/javascript'></script>
    <script src='./js/beautify.js' type='text/javascript'></script>
    <script src='./js/d3.v3.js' type='text/javascript'></script>
    <script src='./js/vega.js' type='text/javascript'></script>
    
    <style>
    .rChart {
      display: block;
      margin-left: auto; 
      margin-right: auto;
      width: 800px;
      height: 400px;
    }  
    </style>
    
  </head>
  <body ng-app='myApp' ng-controller='MainCtrl'>
    
    <div></div>    
        <nav class="uk-navbar">
      <ul class="uk-navbar-nav">
     <li>
      <!--a href="/index.html"-->
         
        <i class='uk-icon-home'> </i>Home
      <!--/a-->
    </li>
    <li>
         <button href="#" class='uk-button uk-button-danger' 
          style='margin-left:5px; margin-top:5px; margin-right:5px;' ng-click='parseSpec()'>
           Submit
          </button>
    </li>
    <li>
      <div class='uk-button uk-button-success' 
        style='margin-left:5px; margin-top:5px; margin-right:5px;'>
      Instant Preview
      <input id="checkSlave" type="checkbox" ng-model="preview">
     </div>
    </li>
  </ul>
    </nav>
        <div class="uk-grid">
  <div id='editor' ng-model='exampleCode' ui-ace="aceOptions">
  </div><br/>
   <div id='vis'>
     
   </div>
   
   <script>
    var lodash = angular.module('lodash', []);
    lodash.factory('_', function () {
      return window._;
      });
    
    var params = {
 "dom": "chart51b8784d52b7",
"width":    800,
"height":    400,
"bodyattrs": "ng-app='myApp' ng-controller='MainCtrl'",
"spec": {
 "data": [
 {
 "name": "price.df_aefcc2b0e44f8ff14429b0c2750497c5",
"format": {
 "type": "csv",
"parse": {
 "close": "number",
"date": "number",
"opacity": "number",
"open": "number",
"high": "number",
"low": "number" 
} 
},
"values": "\"close\",\"date\",\"color\",\"opacity\",\"open\",\"high\",\"low\"\n182.92,1388620800000,\"no\",0,183.98,184.07,182.48\n182.89,1388707200000,\"no\",0,183.23,183.6,182.63\n182.36,1388966400000,\"no\",0,183.49,183.56,182.08\n183.48,1389052800000,\"yes\",1,183.09,183.79,182.95\n183.52,1389139200000,\"yes\",1,183.45,183.83,182.89\n183.64,1389225600000,\"yes\",0,184.11,184.13,182.8\n184.14,1.389312e+12,\"yes\",1,183.95,184.22,183.01\n181.69,1389571200000,\"no\",0,183.67,184.18,181.34\n183.67,1389657600000,\"yes\",1,182.29,183.77,181.95\n184.66,1.389744e+12,\"yes\",1,184.1,184.94,183.71\n184.42,1389830400000,\"no\",1,184.28,184.66,183.83\n183.64,1389916800000,\"no\",0,184.1,184.45,183.32\n184.18,1390262400000,\"yes\",0,184.7,184.77,183.05\n184.3,1390348800000,\"yes\",0,184.49,184.57,183.91\n182.79,1390435200000,\"no\",0,183.37,183.4,181.82\n178.89,1390521600000,\"no\",0,181.6,181.66,178.83\n178.01,1390780800000,\"no\",0,179.06,179.52,177.12\n179.07,1390867200000,\"yes\",1,178.14,179.3,178.12\n177.35,1390953600000,\"no\",0,177.58,178.55,176.88\n179.23,1.39104e+12,\"yes\",1,178.83,179.81,178.26\n178.18,1391126400000,\"no\",1,177.01,179.29,176.92\n174.17,1391385600000,\"no\",0,177.97,178.37,173.83\n175.39,1.391472e+12,\"yes\",1,174.95,175.84,174.11\n175.17,1391558400000,\"no\",1,174.78,175.56,173.71\n177.48,1391644800000,\"yes\",1,175.58,177.48,175.22\n179.68,1391731200000,\"yes\",1,178.31,179.87,177.73\n180.01,1391990400000,\"yes\",1,179.7,180.07,179.21\n181.98,1392076800000,\"yes\",1,180.16,182.44,180.04\n182.07,1392163200000,\"yes\",0,182.25,182.83,181.71\n183.01,1392249600000,\"yes\",1,180.84,183.2,180.83\n184.02,1.392336e+12,\"yes\",1,182.84,184.36,182.67\n184.24,1392681600000,\"yes\",1,184.18,184.49,183.65\n183.02,1.392768e+12,\"no\",0,183.76,184.95,182.87\n184.1,1392854400000,\"yes\",1,183.27,184.52,182.6\n183.89,1392940800000,\"no\",0,184.45,184.89,183.8\n184.91,1.3932e+12,\"yes\",1,184.28,186.15,184.2\n184.84,1393286400000,\"no\",0,185.06,185.59,184.23\n184.85,1393372800000,\"yes\",0,185.11,185.6,184.33\n185.82,1393459200000,\"yes\",1,184.58,185.87,184.37\n186.29,1393545600000,\"yes\",1,185.79,187.15,185.05\n184.98,1393804800000,\"no\",1,184.65,185.45,183.75\n187.58,1393891200000,\"yes\",1,186.79,187.98,186.75" 
} 
],
"scales": [
 {
 "name": "fill",
"type": "ordinal",
"reverse": false,
"round": false,
"points": true,
"sort": true,
"range": [ "red", "green" ],
"domain": [ "no", "yes" ] 
},
{
 "name": "stroke",
"type": "ordinal",
"reverse": false,
"round": false,
"points": true,
"sort": true,
"range": [ "red", "green" ],
"domain": [ "no", "yes" ] 
},
{
 "name": "x",
"type": "time",
"reverse": false,
"round": false,
"clamp": false,
"nice": "week",
"range": "width",
"domain": {
 "fields": [
 {
 "data": "price.df_aefcc2b0e44f8ff14429b0c2750497c5",
"field": "data.date" 
},
{
 "data": "price.df_aefcc2b0e44f8ff14429b0c2750497c5",
"field": "data.date" 
} 
] 
} 
},
{
 "name": "y",
"type": "linear",
"reverse": false,
"round": false,
"clamp": false,
"nice": true,
"zero": false,
"range": "height",
"domain": {
 "fields": [
 {
 "data": "price.df_aefcc2b0e44f8ff14429b0c2750497c5",
"field": "data.close" 
},
{
 "data": "price.df_aefcc2b0e44f8ff14429b0c2750497c5",
"field": "data.open" 
},
{
 "data": "price.df_aefcc2b0e44f8ff14429b0c2750497c5",
"field": "data.high" 
},
{
 "data": "price.df_aefcc2b0e44f8ff14429b0c2750497c5",
"field": "data.low" 
} 
] 
} 
},
{
 "name": "opacity",
"type": "linear",
"reverse": false,
"round": false,
"clamp": false,
"nice": true,
"zero": false,
"range": [      0,      1 ],
"domain": {
 "fields": [
 {
 "data": "price.df_aefcc2b0e44f8ff14429b0c2750497c5",
"field": "data.opacity" 
} 
] 
} 
} 
],
"marks": [
 {
 "type": "rect",
"properties": {
 "update": {
 "y": {
 "scale": "y",
"field": "data.close" 
},
"x": {
 "scale": "x",
"field": "data.date" 
},
"fill": {
 "scale": "fill",
"field": "data.color" 
},
"fillOpacity": {
 "scale": "opacity",
"field": "data.opacity" 
},
"stroke": {
 "scale": "stroke",
"field": "data.color" 
},
"y2": {
 "scale": "y",
"field": "data.open" 
},
"width": {
 "value":      3 
} 
},
"ggvis": {
 "data": {
 "value": "price.df_aefcc2b0e44f8ff14429b0c2750497c5" 
} 
} 
},
"from": {
 "data": "price.df_aefcc2b0e44f8ff14429b0c2750497c5" 
} 
},
{
 "type": "rect",
"properties": {
 "update": {
 "x": {
 "scale": "x",
"field": "data.date" 
},
"fill": {
 "scale": "fill",
"field": "data.color" 
},
"stroke": {
 "scale": "stroke",
"field": "data.color" 
},
"y": {
 "scale": "y",
"field": "data.high" 
},
"y2": {
 "scale": "y",
"field": "data.low" 
},
"width": {
 "value":    0.5 
},
"fillOpacity": {
 "value":      1 
} 
},
"ggvis": {
 "data": {
 "value": "price.df_aefcc2b0e44f8ff14429b0c2750497c5" 
} 
} 
},
"from": {
 "data": "price.df_aefcc2b0e44f8ff14429b0c2750497c5" 
} 
} 
],
"width":    600,
"height":    400,
"legends": [
 {
 "fill": "fill",
"orient": "right",
"title": "" 
},
{
 "stroke": "stroke",
"orient": "right",
"title": "" 
} 
],
"axes": [
 {
 "type": "x",
"scale": "x",
"orient": "bottom",
"layer": "back",
"grid": true,
"title": "date" 
},
{
 "type": "y",
"scale": "y",
"orient": "left",
"layer": "back",
"grid": true,
"title": "close" 
} 
],
"padding": null,
"ggvis_opts": {
 "width":    600,
"height":    400,
"keep_aspect": false,
"resizable": true,
"padding": {},
"duration":    250,
"renderer": "svg",
"hover_duration":      0 
},
"handlers": [] 
},
"id": "chart51b8784d52b7" 
}
    var myApp = angular.module('myApp', ['ui.ace', 'lodash'], 
      function($locationProvider){
        $locationProvider.html5Mode(true);
      }
    )
      
    // parse a spec and create a visualization view
    function parse(spec) {
      return vg.parse.spec(spec, function(chart){
        chart({el:'#vis'}).update(); 
      })
    }
    
    
    myApp.controller('MainCtrl', function($scope, $http, $location){  
      $scope.preview = true
      $scope.exampleCode = js_beautify(JSON.stringify(params.spec))
      
      $scope.aceOptions = {
        theme: 'solarized_light',
        mode: 'json',
        useWrapMode : true
      }
      
      $scope.parseSpec = function(){
        parse(JSON.parse($scope.exampleCode))
      }
      
      $scope.$watch('exampleCode', _.debounce(function(newCode){
        $scope.exampleCode = newCode
        if ($scope.preview){
          $scope.parseSpec()
        }
      }, 3000))
    })
   </script>
    
    
      <script>
      </script>     
          
  </body>
</html>